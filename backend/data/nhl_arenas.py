# NHL Arena Location Database
# This database contains all current NHL arenas with their coordinates and details

NHL_ARENAS = {
    # Team name variations mapped to arena data
    "Anaheim Ducks": {
        "arena": "Honda Center",
        "city": "Anaheim",
        "state": "CA",
        "country": "USA",
        "latitude": 33.8078,
        "longitude": -117.8765
    },
    "Arizona Coyotes": {
        "arena": "Mullett Arena",
        "city": "Tempe",
        "state": "AZ", 
        "country": "USA",
        "latitude": 33.4242,
        "longitude": -111.9281
    },
    "Boston Bruins": {
        "arena": "TD Garden",
        "city": "Boston",
        "state": "MA",
        "country": "USA",
        "latitude": 42.3662,
        "longitude": -71.0621
    },
    "Buffalo Sabres": {
        "arena": "KeyBank Center",
        "city": "Buffalo",
        "state": "NY",
        "country": "USA",
        "latitude": 42.8750,
        "longitude": -78.8763
    },
    "Calgary Flames": {
        "arena": "Scotiabank Saddledome",
        "city": "Calgary",
        "state": "AB",
        "country": "Canada",
        "latitude": 51.0373,
        "longitude": -114.0515
    },
    "Carolina Hurricanes": {
        "arena": "PNC Arena",
        "city": "Raleigh",
        "state": "NC",
        "country": "USA",
        "latitude": 35.8031,
        "longitude": -78.7217
    },
    "Chicago Blackhawks": {
        "arena": "United Center",
        "city": "Chicago",
        "state": "IL",
        "country": "USA",
        "latitude": 41.8807,
        "longitude": -87.6742
    },
    "Colorado Avalanche": {
        "arena": "Ball Arena",
        "city": "Denver",
        "state": "CO",
        "country": "USA",
        "latitude": 39.7487,
        "longitude": -105.0077
    },
    "Columbus Blue Jackets": {
        "arena": "Nationwide Arena",
        "city": "Columbus",
        "state": "OH",
        "country": "USA",
        "latitude": 39.9690,
        "longitude": -83.0061
    },
    "Dallas Stars": {
        "arena": "American Airlines Center",
        "city": "Dallas",
        "state": "TX",
        "country": "USA",
        "latitude": 32.7905,
        "longitude": -96.8104
    },
    "Detroit Red Wings": {
        "arena": "Little Caesars Arena",
        "city": "Detroit",
        "state": "MI",
        "country": "USA",
        "latitude": 42.3412,
        "longitude": -83.0552
    },
    "Edmonton Oilers": {
        "arena": "Rogers Place",
        "city": "Edmonton",
        "state": "AB",
        "country": "Canada",
        "latitude": 53.5468,
        "longitude": -113.4978
    },
    "Florida Panthers": {
        "arena": "Amerant Bank Arena",
        "city": "Sunrise",
        "state": "FL",
        "country": "USA",
        "latitude": 26.1583,
        "longitude": -80.3254
    },
    "Los Angeles Kings": {
        "arena": "Crypto.com Arena",
        "city": "Los Angeles",
        "state": "CA",
        "country": "USA",
        "latitude": 34.0430,
        "longitude": -118.2673
    },
    "Minnesota Wild": {
        "arena": "Xcel Energy Center",
        "city": "St. Paul",
        "state": "MN",
        "country": "USA",
        "latitude": 44.9447,
        "longitude": -93.1012
    },
    "Montreal Canadiens": {
        "arena": "Bell Centre",
        "city": "Montreal",
        "state": "QC",
        "country": "Canada",
        "latitude": 45.4961,
        "longitude": -73.5693
    },
    "Nashville Predators": {
        "arena": "Bridgestone Arena",
        "city": "Nashville",
        "state": "TN",
        "country": "USA",
        "latitude": 36.1591,
        "longitude": -86.7786
    },
    "New Jersey Devils": {
        "arena": "Prudential Center",
        "city": "Newark",
        "state": "NJ",
        "country": "USA",
        "latitude": 40.7336,
        "longitude": -74.1710
    },
    "New York Islanders": {
        "arena": "UBS Arena",
        "city": "Elmont",
        "state": "NY",
        "country": "USA",
        "latitude": 40.7226,
        "longitude": -73.5906
    },
    "New York Rangers": {
        "arena": "Madison Square Garden",
        "city": "New York",
        "state": "NY",
        "country": "USA",
        "latitude": 40.7505,
        "longitude": -73.9934
    },
    "Ottawa Senators": {
        "arena": "Canadian Tire Centre",
        "city": "Ottawa",
        "state": "ON",
        "country": "Canada",
        "latitude": 45.2968,
        "longitude": -75.9270
    },
    "Philadelphia Flyers": {
        "arena": "Wells Fargo Center",
        "city": "Philadelphia",
        "state": "PA",
        "country": "USA",
        "latitude": 39.9012,
        "longitude": -75.1720
    },
    "Pittsburgh Penguins": {
        "arena": "PPG Paints Arena",
        "city": "Pittsburgh",
        "state": "PA",
        "country": "USA",
        "latitude": 40.4396,
        "longitude": -79.9892
    },
    "San Jose Sharks": {
        "arena": "SAP Center",
        "city": "San Jose",
        "state": "CA",
        "country": "USA",
        "latitude": 37.3326,
        "longitude": -121.9010
    },
    "Seattle Kraken": {
        "arena": "Climate Pledge Arena",
        "city": "Seattle",
        "state": "WA",
        "country": "USA",
        "latitude": 47.6221,
        "longitude": -122.3540
    },
    "St. Louis Blues": {
        "arena": "Enterprise Center",
        "city": "St. Louis",
        "state": "MO",
        "country": "USA",
        "latitude": 38.6266,
        "longitude": -90.2026
    },
    "Tampa Bay Lightning": {
        "arena": "Amalie Arena",
        "city": "Tampa",
        "state": "FL",
        "country": "USA",
        "latitude": 27.9428,
        "longitude": -82.4517
    },
    "Toronto Maple Leafs": {
        "arena": "Scotiabank Arena",
        "city": "Toronto",
        "state": "ON",
        "country": "Canada",
        "latitude": 43.6434,
        "longitude": -79.3791
    },
    "Utah Hockey Club": {
        "arena": "Delta Center",
        "city": "Salt Lake City",
        "state": "UT",
        "country": "USA",
        "latitude": 40.7683,
        "longitude": -111.9016
    },
    "Vancouver Canucks": {
        "arena": "Rogers Arena",
        "city": "Vancouver",
        "state": "BC",
        "country": "Canada",
        "latitude": 49.2778,
        "longitude": -123.1089
    },
    "Vegas Golden Knights": {
        "arena": "T-Mobile Arena",
        "city": "Las Vegas",
        "state": "NV",
        "country": "USA",
        "latitude": 36.1028,
        "longitude": -115.1781
    },
    "Washington Capitals": {
        "arena": "Capital One Arena",
        "city": "Washington",
        "state": "DC",
        "country": "USA",
        "latitude": 38.8981,
        "longitude": -77.0209
    },
    "Winnipeg Jets": {
        "arena": "Canada Life Centre",
        "city": "Winnipeg",
        "state": "MB",
        "country": "Canada",
        "latitude": 49.8928,
        "longitude": -97.1436
    }
}

# Team abbreviations and alternative names mapping
TEAM_ALIASES = {
    # Common abbreviations
    "ANA": "Anaheim Ducks",
    "ARI": "Arizona Coyotes", 
    "BOS": "Boston Bruins",
    "BUF": "Buffalo Sabres",
    "CGY": "Calgary Flames",
    "CAR": "Carolina Hurricanes",
    "CHI": "Chicago Blackhawks",
    "COL": "Colorado Avalanche",
    "CBJ": "Columbus Blue Jackets",
    "DAL": "Dallas Stars",
    "DET": "Detroit Red Wings",
    "EDM": "Edmonton Oilers",
    "FLA": "Florida Panthers",
    "LAK": "Los Angeles Kings",
    "MIN": "Minnesota Wild",
    "MTL": "Montreal Canadiens",
    "NSH": "Nashville Predators",
    "NJD": "New Jersey Devils",
    "NYI": "New York Islanders",
    "NYR": "New York Rangers",
    "OTT": "Ottawa Senators",
    "PHI": "Philadelphia Flyers",
    "PIT": "Pittsburgh Penguins",
    "SJS": "San Jose Sharks",
    "SEA": "Seattle Kraken",
    "STL": "St. Louis Blues",
    "TBL": "Tampa Bay Lightning",
    "TOR": "Toronto Maple Leafs",
    "UTA": "Utah Hockey Club",
    "VAN": "Vancouver Canucks",
    "VGK": "Vegas Golden Knights",
    "WSH": "Washington Capitals",
    "WPG": "Winnipeg Jets",
    
    # Alternative team names
    "Los Angeles": "Los Angeles Kings",
    "New York": "New York Rangers",  # Default to Rangers for ambiguous "New York"
    "Tampa Bay": "Tampa Bay Lightning",
    "San Jose": "San Jose Sharks",
    "St. Louis": "St. Louis Blues",
    "New Jersey": "New Jersey Devils",
    "Vegas": "Vegas Golden Knights",
    "Utah": "Utah Hockey Club",
    
    # Historical/Alternative names
    "Phoenix Coyotes": "Arizona Coyotes",
    "Atlanta Thrashers": "Winnipeg Jets",  # Moved franchise
}

def get_arena_location(team_name: str):
    """
    Get arena location data for a given team name.
    
    Args:
        team_name: Team name (full name, abbreviation, or alternative name)
        
    Returns:
        dict: Arena location data or None if not found
    """
    # Direct lookup
    if team_name in NHL_ARENAS:
        return NHL_ARENAS[team_name]
    
    # Try aliases
    if team_name in TEAM_ALIASES:
        canonical_name = TEAM_ALIASES[team_name]
        return NHL_ARENAS.get(canonical_name)
    
    # Try fuzzy matching (case-insensitive)
    team_name_lower = team_name.lower()
    for team, data in NHL_ARENAS.items():
        if team.lower() == team_name_lower:
            return data
    
    # Try partial matching
    for team, data in NHL_ARENAS.items():
        if team_name_lower in team.lower() or team.lower() in team_name_lower:
            return data
    
    return None

def get_home_arena_location(home_team: str):
    """
    Get the home arena location for a game.
    
    Args:
        home_team: Home team name
        
    Returns:
        dict: Arena location data with coordinates
    """
    return get_arena_location(home_team)